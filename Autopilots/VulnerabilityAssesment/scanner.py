import sys
from modules import (
    http_header_check, ssl_check, sql_injection_check, xss_check, csrf_check,
    robots_check, directory_bruteforce, open_redirect_check, subdomain_enum,
    file_inclusion_check, cookie_security_check, cors_check, rate_limiting_check,
    sitemap_check, sensitive_info_disclosure, version_detection, brute_force_login,
    outdated_software_check, port_scanner
)

def main(url):
    print(f"Scanning {url}...")
    http_header_check.scan(url)
    ssl_check.scan(url)
    sql_injection_check.scan(url)
    xss_check.scan(url)
    csrf_check.scan(url)
    robots_check.scan(url)
    directory_bruteforce.scan(url)
    open_redirect_check.scan(url)
    subdomain_enum.scan(url)
    file_inclusion_check.scan(url)
    cookie_security_check.scan(url)
    cors_check.scan(url)
    rate_limiting_check.scan(url)
    sitemap_check.scan(url)
    sensitive_info_disclosure.scan(url)
    version_detection.scan(url)
    brute_force_login.scan(url)
    outdated_software_check.scan(url)
    port_scanner.scan(url)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print("Usage: python3 scanner.py <url>")
        sys.exit(1)
    main(sys.argv[1])
